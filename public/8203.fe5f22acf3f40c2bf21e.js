(self.webpackChunkdynamic_ui_ion=self.webpackChunkdynamic_ui_ion||[]).push([[8203],{8203:(t,e,n)=>{"use strict";n.r(e),n.d(e,{HomePageModule:()=>U});var i=n(8583),o=n(665),s=n(7823),a=n(2234),r=n(4762),c=n(4091),l=(()=>(function(t){t[t.INIT=0]="INIT",t[t.CONFIGURACION=1]="CONFIGURACION",t[t.STOPPED=2]="STOPPED",t[t.READY=3]="READY",t[t.RUNNING=4]="RUNNING",t[t.WAITING=5]="WAITING"}(l||(l={})),l))(),g=n(3685),p=n(5206),h=n(8720),d=n(8058),u=n(7556),m=n(9265),f=n(4509);function x(t,e){if(1&t&&(h.TgZ(0,"p",11),h.TgZ(1,"strong"),h._uU(2,"OT: "),h.qZA(),h._uU(3),h.qZA()),2&t){const t=h.oxw();h.xp6(3),h.Oqu(t.po.name)}}function b(t,e){1&t&&(h.TgZ(0,"h1",11),h._uU(1,"No hay orden en proceso"),h.qZA())}function Z(t,e){if(1&t&&(h.TgZ(0,"p",12),h.TgZ(1,"strong"),h._uU(2,"Producto: "),h.qZA(),h._uU(3),h.qZA()),2&t){const t=h.oxw();h.xp6(3),h.Oqu(t.product.name)}}function w(t,e){if(1&t&&(h.TgZ(0,"p",13),h.TgZ(1,"strong"),h._uU(2,"Lote: "),h.qZA(),h._uU(3),h.qZA()),2&t){const t=h.oxw();h.xp6(3),h.Oqu(t.batch.name)}}const _=function(t,e,n,i,o,s){return{init:t,stopped:e,stoppedby:n,ready:i,running:o,waiting:s}};let O=(()=>{class t{constructor(t){this.cd=t,this.init=!1,this.machine_state="",this.speed="45"}ngOnInit(){this.init=!0,this.setTextState(),console.log(this.state)}ngAfterViewInit(){this.cd.detectChanges()}ngOnChanges(t){this.init&&this.setTextState()}setTextState(){if(this.init){switch(this.state){case 0:this.machine_state="INICIANDO SISTEMA";break;case 1:this.machine_state="CONFIGURACION";break;case 2:this.machine_state="DETENIDA";break;case 3:this.machine_state="LISTA";break;case 4:this.machine_state="EN MARCHA";break;case 5:this.machine_state="ESPERA"}console.log(this.machine_state)}}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(h.sBO))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-status-bar"]],inputs:{po:"po",product:"product",batch:"batch",state:"state"},features:[h.TTD],decls:15,vars:14,consts:[[1,"status-bar","frame",3,"ngClass"],[1,"col-1","border"],[1,"text-container"],["class","po-name",4,"ngIf"],["class","product-name",4,"ngIf"],["class","batch-name",4,"ngIf"],[1,"machine-state-container"],[1,"machine-state"],[1,"col-1"],[1,"info-container"],[1,"speed"],[1,"po-name"],[1,"product-name"],[1,"batch-name"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.TgZ(1,"div",1),h.TgZ(2,"div",2),h.YNc(3,x,4,1,"p",3),h.YNc(4,b,2,0,"h1",3),h.YNc(5,Z,4,1,"p",4),h.YNc(6,w,4,1,"p",5),h.qZA(),h.qZA(),h.TgZ(7,"div",1),h.TgZ(8,"div",6),h.TgZ(9,"h2",7),h._uU(10),h.qZA(),h.qZA(),h.qZA(),h.TgZ(11,"div",8),h.TgZ(12,"div",9),h.TgZ(13,"h2",10),h._uU(14),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t&&(h.Q6J("ngClass",h.HTZ(7,_,0===e.state,1===e.state,2===e.state,3===e.state,4===e.state,5===e.state)),h.xp6(3),h.Q6J("ngIf",e.po),h.xp6(1),h.Q6J("ngIf",!e.po),h.xp6(1),h.Q6J("ngIf",e.product),h.xp6(1),h.Q6J("ngIf",e.batch),h.xp6(4),h.Oqu(e.machine_state),h.xp6(4),h.hij("Velocidad: ",e.speed," m/min"))},directives:[i.mk,i.O5],styles:["@keyframes animation-status{0%{opacity:.3;top:-100px}90%{opacity:1;top:0}}.frame[_ngcontent-%COMP%]{position:relative;animation-name:animation-status;animation-duration:1s;animation-timing-function:ease-in-out}.status-bar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;border-radius:20px;margin-left:15px;margin-right:15px;height:100%}.init[_ngcontent-%COMP%]{background:linear-gradient(180deg,#232423,#161817 45%,#3c3d3c)}.running[_ngcontent-%COMP%]{background:linear-gradient(180deg,#34c96d,#189142 45%,#062811)}.ready[_ngcontent-%COMP%]{background:linear-gradient(180deg,#5d9eff,#285a97 45%,#17324e7d)}.stopped[_ngcontent-%COMP%]{background:linear-gradient(180deg,#e27679e9,#962020 45%,#962020)}.stoppedby[_ngcontent-%COMP%]{background:linear-gradient(180deg,#e27679e9,#e96107 45%,#962020)}.waiting[_ngcontent-%COMP%]{background:linear-gradient(180deg,#dfe276e9,#968620 45%,#968620)}.border[_ngcontent-%COMP%]{border-right:1px solid #c4c7d1}.col-1[_ngcontent-%COMP%]{width:33%;height:78%;justify-content:center}.col-1[_ngcontent-%COMP%], .text-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:nowrap}.text-container[_ngcontent-%COMP%]{justify-content:space-between;align-items:flex-start;align-content:center;padding-top:6px;padding-bottom:6px;padding-left:23px;color:#ddd8d8}.header[_ngcontent-%COMP%]{background:linear-gradient(181deg,#666,#262626)}.po-name[_ngcontent-%COMP%]{margin:0 0 0 4px}.po-name[_ngcontent-%COMP%], .product-name[_ngcontent-%COMP%]{font-size:15px;line-height:20px}.product-name[_ngcontent-%COMP%]{margin:0 0 0 12px}.batch-name[_ngcontent-%COMP%]{font-size:15px;margin:0 0 0 20px;line-height:20px}.machine-state-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;flex-wrap:nowrap;align-content:center;padding-top:6px;padding-bottom:6px}.machine-state[_ngcontent-%COMP%]{color:#d5cdcd;font-size:26px;margin:0}.info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:flex-start;flex-wrap:nowrap;align-content:center;padding-top:6px;padding-bottom:6px;padding-left:35px}.speed[_ngcontent-%COMP%]{color:#d5cdcd;font-size:18px;margin:0}"]}),t})();var C=n(6859);function S(t,e){if(1&t&&(h.TgZ(0,"div",1),h.TgZ(1,"div",2),h.TgZ(2,"h1",3),h._uU(3," Aceptados "),h.qZA(),h.TgZ(4,"h1",4),h._uU(5),h.qZA(),h.qZA(),h.TgZ(6,"div",5),h.TgZ(7,"div",6),h._UZ(8,"circle-progress",7),h.qZA(),h.TgZ(9,"div",8),h.TgZ(10,"h1",9),h._uU(11),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(5),h.hij(" ",t.stats.OK," "),h.xp6(3),h.Q6J("percent",t.stats.percentageOK)("titleFontSize",t.fontSize)("titleColor","#bfbfbf")("unitsColor","#bfbfbf")("outerStrokeColor","#33FF3C")("outerStrokeGradientStopColor","#53a9ff")("innerStrokeColor","#DE122E")("showTitle",!0)("showSubtitle",!1)("subtitle","Actual")("showUnits",!0)("showInnerStroke",!0)("showZeroOuterStroke",!0)("radius",50)("outerStrokeLinecap","square")("outerStrokeWidth",6)("innerStrokeWidth",6)("space",-6)("startFromZero",!1)("clockwise",!0)("animation",!0)("animateTitle",!0)("animateSubtitle",!0)("animationDuration",300)("responsive",!0),h.xp6(3),h.hij(" Total: ",t.stats.Total," ")}}let k=(()=>{class t{constructor(){this.fontSize="24"}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-stats-good-frame"]],inputs:{stats:"stats"},decls:1,vars:1,consts:[["class","container-stats frame",4,"ngIf"],[1,"container-stats","frame"],[1,"container-top"],[1,"tittle-top"],[1,"text-top"],[1,"container-bottom"],[1,"container-circle"],["unitsFontSize","16",3,"percent","titleFontSize","titleColor","unitsColor","outerStrokeColor","outerStrokeGradientStopColor","innerStrokeColor","showTitle","showSubtitle","subtitle","showUnits","showInnerStroke","showZeroOuterStroke","radius","outerStrokeLinecap","outerStrokeWidth","innerStrokeWidth","space","startFromZero","clockwise","animation","animateTitle","animateSubtitle","animationDuration","responsive"],[1,"container-text-bottom"],[1,"text-bottom"]],template:function(t,e){1&t&&h.YNc(0,S,12,27,"div",0),2&t&&h.Q6J("ngIf",e.stats)},directives:[i.O5,C.nu],styles:["@keyframes animation-good{0%{opacity:.3;top:-200px}25%{opacity:1;top:0}}.frame[_ngcontent-%COMP%]{position:relative;animation-name:animation-good;animation-duration:3s;animation-timing-function:ease-in-out}.container-stats[_ngcontent-%COMP%]{width:100%;border-radius:20px;overflow:hidden;box-shadow:5px 3px 15px #000}.container-top[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:#fff;padding:5px}.container-bottom[_ngcontent-%COMP%]{height:150px;display:flex;flex-direction:row;justify-content:space-around;align-items:center;background:linear-gradient(45deg,#1010106b,#192c1594)}.container-circle[_ngcontent-%COMP%]{width:35%;max-width:125px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding-top:20px;padding-bottom:20px}.tittle-top[_ngcontent-%COMP%]{font-size:min(4.3vh,24px)}.text-top[_ngcontent-%COMP%], .tittle-top[_ngcontent-%COMP%]{color:#32af37;margin-top:0;margin-bottom:0}.text-top[_ngcontent-%COMP%]{font-size:min(5.5vh,30px);font-weight:500}.container-text-bottom[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;width:50%}.text-center[_ngcontent-%COMP%]{font-size:20px;color:#fff}.text-bottom[_ngcontent-%COMP%]{font-size:22px;color:#fff}"]}),t})();function A(t,e){if(1&t&&(h.TgZ(0,"div",1),h.TgZ(1,"div",2),h.TgZ(2,"h1",3),h._uU(3," Rechazados "),h.qZA(),h.TgZ(4,"h1",4),h._uU(5),h.qZA(),h.qZA(),h.TgZ(6,"div",5),h.TgZ(7,"div",6),h._UZ(8,"circle-progress",7),h.TgZ(9,"h1",8),h._uU(10," Alto "),h.qZA(),h.qZA(),h.TgZ(11,"div",6),h._UZ(12,"circle-progress",7),h.TgZ(13,"h1",8),h._uU(14," Bajo "),h.qZA(),h.qZA(),h.TgZ(15,"div",6),h._UZ(16,"circle-progress",7),h.TgZ(17,"h1",8),h._uU(18," Otros "),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t){const t=h.oxw();h.xp6(5),h.hij(" ",t.stats.NOK," "),h.xp6(3),h.Q6J("percent",t.stats.percentagesReason[0])("titleFontSize",t.fontSize)("titleColor","#bfbfbf")("unitsColor","#bfbfbf")("outerStrokeColor","yellow")("outerStrokeGradientStopColor","#53a9ff")("innerStrokeColor","#dfe0e33c")("showTitle",!0)("showSubtitle",!1)("subtitle","Actual")("showUnits",!0)("showInnerStroke",!0)("showZeroOuterStroke",!0)("radius",40)("outerStrokeWidth",3)("innerStrokeWidth",3)("space",-3)("startFromZero",!1)("clockwise",!0)("animation",!0)("animateTitle",!0)("animateSubtitle",!0)("animationDuration",300)("responsive",!0),h.xp6(4),h.Q6J("percent",t.stats.percentagesReason[1])("titleFontSize",t.fontSize)("titleColor","#bfbfbf")("unitsColor","#bfbfbf")("outerStrokeColor","#E35C05")("outerStrokeGradientStopColor","#53a9ff")("innerStrokeColor","#dfe0e33c")("showTitle",!0)("showSubtitle",!1)("subtitle","Actual")("showUnits",!0)("showInnerStroke",!0)("showZeroOuterStroke",!0)("radius",40)("outerStrokeWidth",3)("innerStrokeWidth",3)("space",-3)("startFromZero",!1)("clockwise",!0)("animation",!0)("animateTitle",!0)("animateSubtitle",!0)("animationDuration",300)("responsive",!0),h.xp6(4),h.Q6J("percent",t.stats.percentagesReason[2])("titleFontSize",t.fontSize)("titleColor","#bfbfbf")("unitsColor","#bfbfbf")("outerStrokeColor","#3383FF")("outerStrokeGradientStopColor","#53a9ff")("innerStrokeColor","#dfe0e33c")("showTitle",!0)("showSubtitle",!1)("subtitle","Actual")("showUnits",!0)("showInnerStroke",!0)("showZeroOuterStroke",!0)("radius",40)("outerStrokeWidth",3)("innerStrokeWidth",3)("space",-3)("startFromZero",!1)("clockwise",!0)("animation",!0)("animateTitle",!0)("animateSubtitle",!0)("animationDuration",300)("responsive",!0)}}let T=(()=>{class t{constructor(){this.fontSize="24"}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-stats-bad-frame"]],inputs:{stats:"stats"},decls:1,vars:1,consts:[["class","container-stats frame",4,"ngIf"],[1,"container-stats","frame"],[1,"container-top"],[1,"tittle-top"],[1,"text-top"],[1,"container-bottom"],[1,"container-circle"],["unitsFontSize","16",3,"percent","titleFontSize","titleColor","unitsColor","outerStrokeColor","outerStrokeGradientStopColor","innerStrokeColor","showTitle","showSubtitle","subtitle","showUnits","showInnerStroke","showZeroOuterStroke","radius","outerStrokeWidth","innerStrokeWidth","space","startFromZero","clockwise","animation","animateTitle","animateSubtitle","animationDuration","responsive"],[1,"text-bottom"]],template:function(t,e){1&t&&h.YNc(0,A,19,73,"div",0),2&t&&h.Q6J("ngIf",e.stats)},directives:[i.O5,C.nu],styles:["@keyframes animation-bad{0%{opacity:.3;left:-200px}25%{opacity:1;left:0}}.frame[_ngcontent-%COMP%]{position:relative;animation-name:animation-bad;animation-duration:2s;animation-timing-function:ease-in-out}.container-stats[_ngcontent-%COMP%]{width:100%;border-radius:20px;overflow:hidden;box-shadow:5px 3px 5px #000}.container-top[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:#fff;padding:5px}.container-bottom[_ngcontent-%COMP%]{height:150px;display:flex;flex-direction:row;justify-content:space-around;align-items:center;background:linear-gradient(45deg,#1010106b,#2c151594)}.container-circle[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:20px;width:33%;max-width:85px;padding:5px}.tittle-top[_ngcontent-%COMP%]{font-size:min(4.3vh,24px)}.text-top[_ngcontent-%COMP%], .tittle-top[_ngcontent-%COMP%]{color:#de122e;margin-top:0;margin-bottom:0}.text-top[_ngcontent-%COMP%]{font-size:min(5.5vh,30px);font-weight:500}.container-text-bottom[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;width:55%;background-color:#000}.text-bottom[_ngcontent-%COMP%], .text-center[_ngcontent-%COMP%]{font-size:20px;color:#fff}.text-bottom[_ngcontent-%COMP%]{margin-top:5px}"]}),t})(),y=(()=>{class t{constructor(){this.weight=0,this.result=0,this.limits={max:0,min:0},this.titleFontSize="16",this.subtitleFontSize="10"}ngOnInit(){}formatSubtitle(t){return t>=100?"Sobrepeso":t<=7.8&&t>=6.4?"Aceptado":t<6.4?"Peso bajo":"--"}color(){switch(this.result){case 0:return"#33FF3C";default:return"#FF0F0F"}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-weight-circle"]],inputs:{weight:"weight",result:"result",limits:"limits"},decls:9,vars:30,consts:[[1,"container-weight","frame"],[1,"container-text-max"],[1,"text-max"],[1,"circle-container"],["unitsFontSize","16","units"," g",3,"percent","title","titleFontSize","titleColor","unitsColor","outerStrokeColor","outerStrokeGradientStopColor","innerStrokeColor","showTitle","showSubtitle","subtitle","subtitleColor","subtitleFontSize","showUnits","showInnerStroke","showZeroOuterStroke","radius","outerStrokeWidth","innerStrokeWidth","space","startFromZero","clockwise","animation","animateTitle","animateSubtitle","animationDuration","responsive","subtitleFormat"],[1,"container-text-min"],[1,"text-min"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.TgZ(1,"div",1),h.TgZ(2,"h1",2),h._uU(3),h.qZA(),h.qZA(),h.TgZ(4,"div",3),h._UZ(5,"circle-progress",4),h.qZA(),h.TgZ(6,"div",5),h.TgZ(7,"h1",6),h._uU(8),h.qZA(),h.qZA(),h.qZA()),2&t&&(h.xp6(3),h.hij(" M\xe1ximo: ",e.limits.max," g "),h.xp6(2),h.Q6J("percent",e.weight)("title",e.weight.toString())("titleFontSize",e.titleFontSize)("titleColor","#bfbfbf")("unitsColor","#bfbfbf")("outerStrokeColor",e.color())("outerStrokeGradientStopColor","#53a9ff")("innerStrokeColor","#626567")("showTitle",!0)("showSubtitle",!1)("subtitle","--")("subtitleColor","#33FF3C")("subtitleFontSize",e.subtitleFontSize)("showUnits",!0)("showInnerStroke",!0)("showZeroOuterStroke",!0)("radius",50)("outerStrokeWidth",6)("innerStrokeWidth",6)("space",-6)("startFromZero",!1)("clockwise",!0)("animation",!0)("animateTitle",!0)("animateSubtitle",!1)("animationDuration",150)("responsive",!0)("subtitleFormat",e.formatSubtitle),h.xp6(3),h.hij(" M\xednimo: ",e.limits.min," g "))},directives:[C.nu],styles:["@keyframes animation-weight{0%{opacity:.3;bottom:-800px}25%{opacity:1;bottom:0}}.frame[_ngcontent-%COMP%]{position:relative;animation-name:animation-weight;animation-duration:2s;animation-timing-function:ease-in-out}.container-weight[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;max-width:550px}.circle-container[_ngcontent-%COMP%]{max-width:400px;width:100%}.container-text-max[_ngcontent-%COMP%]{margin-top:20px}.container-text-max[_ngcontent-%COMP%], .container-text-min[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.container-text-min[_ngcontent-%COMP%]{color:#fff;margin-top:10px}.text-max[_ngcontent-%COMP%], .text-min[_ngcontent-%COMP%]{color:#fff;font-size:25px;margin:0 auto}.text-center[_ngcontent-%COMP%]{color:#fff;font-size:64px}.circle[_ngcontent-%COMP%]{color:blue}"]}),t})();function P(t,e){if(1&t&&(h.TgZ(0,"ion-item"),h.TgZ(1,"ion-avatar",4),h._UZ(2,"img",5),h.qZA(),h.TgZ(3,"ion-label"),h.TgZ(4,"p"),h._uU(5),h.ALo(6,"date"),h.qZA(),h.qZA(),h.TgZ(7,"ion-note"),h._uU(8),h.qZA(),h.qZA()),2&t){const t=e.$implicit,n=h.oxw();h.xp6(2),h.Q6J("src",n.avatar(t.state),h.LSH),h.xp6(3),h.Oqu(h.xi3(6,3,t.createdAt,"d/M/yy H:mm")),h.xp6(3),h.hij("",t.value," g")}}let M=(()=>{class t{constructor(){}ngOnInit(){}avatar(t){switch(t){case 0:return"../../../assets/check-ok.svg";case 1:return"../../../assets/arrow-up.svg";case 2:return"../../../assets/arrow-down.svg";case 3:return"../../../assets/circle.svg"}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-list-weight"]],inputs:{units:"units"},decls:6,vars:1,consts:[[1,"container-list","frame"],["mode","ios"],[1,"ion-margin-top"],[4,"ngFor","ngForOf"],["slot","start",1,"ion-no-margin"],[3,"src"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.TgZ(1,"ion-list",1),h.TgZ(2,"ion-list-header"),h.TgZ(3,"ion-label",2),h._uU(4,"Historial"),h.qZA(),h.qZA(),h.YNc(5,P,9,6,"ion-item",3),h.qZA(),h.qZA()),2&t&&(h.xp6(5),h.Q6J("ngForOf",e.units))},directives:[s.q_,s.yh,s.Q$,i.sg,s.Ie,s.BJ,s.uN],pipes:[i.uU],styles:["@keyframes animation-list{0%{opacity:.3;right:-200px}to{opacity:1;right:0}}.frame[_ngcontent-%COMP%]{position:relative;animation-name:animation-list;animation-duration:1s;animation-timing-function:ease-in-out}.container-list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-content:center}.non-block[_ngcontent-%COMP%]{display:inline}.img[_ngcontent-%COMP%]{height:25px;width:25px}ion-note[_ngcontent-%COMP%]{--color:#a8a8a8}"]}),t})();const v=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,s,a){this.storageService=t,this.authService=e,this.alertController=n,this.router=i,this.httpClient=o,this.platform=s,this.webSocket=a,this.ws=null,this.connection_state=!1,this.stats={OK:0,NOK:0,Total:0,percentageOK:0,percentageNOK:0,percentagesReason:[]},this.weight=0,this.result=0,this.limits={max:0,min:0},this.userName="",this.machine_state=l.READY,this.cmd_main_ui=new p.O,this.disabled_menu=!1}ngOnInit(){console.log("home loaded"),setInterval(()=>this.time=Date.now(),1e3),this.userSubscription=this.storageService.userData.subscribe(t=>{console.log(t),this.user=t,this.userName=null===t?"Sin usuario":t.firstName+" "+t.lastName}),this.platforms=this.platform.platforms();for(let t=0;t<this.platforms.length;t++)if("mobileweb"==this.platforms[t]||"pwa"==this.platforms[t]){this.plat="web";break}this.storageService.get(c.l.USER).then(t=>{console.log(t)}),this.uri="web"===this.plat?g.N.ws_local:g.N.ws_mobile,this.webSocket.createWebSocket(this.uri),this.webSocket.wsMsg$.subscribe(t=>{this.handleMessageWS(t)})}ngOnDestroy(){this.userSubscription.unsubscribe()}ionViewWillEnter(){console.log("home will enter"),this.getActivePO(),this.webSocket.sendWebSocket(this.cmd_main_ui.configOff)}ionViewWillLeave(){this.webSocket.sendWebSocket(this.cmd_main_ui.configOn),console.log("home will leave")}handleMessageWS(t){switch(this.msg=t,console.log(this.msg.payload),this.msg.command){case"stats":console.log("stats"),this.stats=this.msg.payload.stats;break;case"weight":console.log("Weight received: ",this.msg.payload.weight),this.weight=this.msg.payload.weight.weight,this.result=this.msg.payload.weight.state,this.updateList();break;case"limits":console.log("limits"),this.limits=this.msg.payload.limits;break;case"machine_state":switch(console.log("machine_state: ",this.msg.payload.state),this.msg.payload.state){case 0:this.machine_state=l.READY,this.disabled_menu=!1;break;case 1:this.machine_state=l.RUNNING,this.disabled_menu=!0;break;case 5:this.machine_state=l.STOPPED,this.disabled_menu=!1;break;default:this.machine_state=l.READY,this.disabled_menu=!1}}}logout(){return(0,r.mG)(this,void 0,void 0,function*(){if(null===this.user)this.router.navigate(["login"]);else{const t=yield this.alertController.create({header:"Atenci\xf3n!",message:"\xbfDesea cerrar la sesi\xf3n?",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Si",handler:()=>{this.authService.logout().then()}}]});yield t.present()}})}updateList(){switch(this.machine_state){case l.RUNNING:this.getUnitListAndStats(11,this.batch.id)}}getActivePO(){this.httpClient.getActivePO().subscribe(t=>{console.log(t),0===t.length?(console.log("po cerrada"),this.po=null,this.batch=null,this.product=null,this.limits.max=0,this.limits.min=0,this.stats.OK=0,this.stats.NOK=0,this.stats.Total=0,this.stats.percentageNOK=0,this.stats.percentageOK=0,this.stats.percentagesReason[0]=0,this.stats.percentagesReason[1]=0,this.stats.percentagesReason[2]=0):(this.po=t[0],this.batch=t[0].batches.filter(t=>1==t.state)[0],this.product=t[0].products[0],this.limits.max=this.product.weightMax,this.limits.min=this.product.weightMin,this.getUnitListAndStats(11,this.batch.id))},t=>{this.presentAlert("No se recibio respuesta del servidor")})}getUnitListAndStats(t,e){this.httpClient.getUnitListAndStats(t,e).subscribe(t=>{this.units=t.list,this.stats.OK=t.stats.okTotal,this.stats.NOK=t.stats.nokHigh+t.stats.nokLow+t.stats.nokOther,this.stats.Total=this.stats.OK+this.stats.NOK,this.stats.percentageNOK=this.stats.NOK/this.stats.Total*100,this.stats.percentageOK=this.stats.OK/this.stats.Total*100,this.stats.percentagesReason[0]=t.stats.nokHigh/this.stats.NOK*100,this.stats.percentagesReason[1]=t.stats.nokLow/this.stats.NOK*100,this.stats.percentagesReason[2]=t.stats.nokOther/this.stats.NOK*100})}presentAlert(t){return(0,r.mG)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:"Alerta",message:t,buttons:[{text:"OK",role:"ok",handler:t=>{console.log("Confirm Cancel: blah")}}]});yield e.present(),setTimeout(()=>e.dismiss(),2e3)})}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(d.V),h.Y36(u.e),h.Y36(s.Br),h.Y36(a.F0),h.Y36(m.O),h.Y36(s.t4),h.Y36(f.l))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-home"]],decls:32,vars:16,consts:[[1,"header"],["color","dark","slot","start","fill","clear","mode","ios","collapse","true",3,"click"],["name","person-circle-outline","slot","icon-only"],[1,"ion-padding-start"],[1,"center","caveat"],[1,"hour-container"],[1,"hour"],[1,"home-screen"],[1,"status-bar-container"],[1,"status-bar",3,"po","product","batch","state"],[1,"home-container-grid"],[1,"home-container"],["size-md","4",1,"stats"],[1,"stats-frame-container"],[3,"stats"],["size-md","5",1,"ion-align-items-center"],[1,"weight-div"],[3,"weight","result","limits"],["size-md","3",1,"list-container"],[3,"units"],["slot","end","collapse","true"],["color","dark",3,"disabled"]],template:function(t,e){1&t&&(h.TgZ(0,"ion-header",0),h.TgZ(1,"ion-toolbar"),h.TgZ(2,"ion-button",1),h.NdJ("click",function(){return e.logout()}),h._UZ(3,"ion-icon",2),h.TgZ(4,"p",3),h._uU(5),h.qZA(),h.qZA(),h.TgZ(6,"ion-title",4),h._uU(7,"Dynamic - QA"),h.qZA(),h.TgZ(8,"div",5),h.TgZ(9,"p",6),h._uU(10),h.ALo(11,"date"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-content",7),h.TgZ(13,"div",8),h._UZ(14,"app-status-bar",9),h.qZA(),h.TgZ(15,"ion-grid",10),h.TgZ(16,"ion-row",11),h.TgZ(17,"ion-col",12),h.TgZ(18,"div",13),h._UZ(19,"app-stats-good-frame",14),h.qZA(),h.TgZ(20,"div",13),h._UZ(21,"app-stats-bad-frame",14),h.qZA(),h.qZA(),h.TgZ(22,"ion-col",15),h.TgZ(23,"div",16),h._UZ(24,"app-weight-circle",17),h.qZA(),h.qZA(),h.TgZ(25,"ion-col",18),h.TgZ(26,"div"),h._UZ(27,"app-list-weight",19),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(28,"ion-footer"),h.TgZ(29,"ion-toolbar"),h.TgZ(30,"ion-buttons",20),h._UZ(31,"ion-menu-button",21),h.qZA(),h.qZA(),h.qZA()),2&t&&(h.xp6(5),h.Oqu(e.userName),h.xp6(5),h.Oqu(h.xi3(11,13,e.time,"d/M/y H:mm")),h.xp6(4),h.Q6J("po",e.po)("product",e.product)("batch",e.batch)("state",e.machine_state),h.xp6(5),h.Q6J("stats",e.stats),h.xp6(2),h.Q6J("stats",e.stats),h.xp6(3),h.Q6J("weight",e.weight)("result",e.result)("limits",e.limits),h.xp6(3),h.Q6J("units",e.units),h.xp6(4),h.Q6J("disabled",e.disabled_menu))},directives:[s.Gu,s.sr,s.YG,s.gu,s.wd,s.W2,O,s.jY,s.Nd,s.wI,k,T,y,M,s.fr,s.Sm,s.fG],pipes:[i.uU],styles:[".home-screen[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%}.home-container-grid[_ngcontent-%COMP%]{background:#0b3681;background:radial-gradient(circle,#0b3681a6 0,#071220 35%,#041024d9 100%);height:85%}.home-container[_ngcontent-%COMP%]{height:100%}.status-bar-container[_ngcontent-%COMP%]{width:100%;height:15%;background:#041024d9}.caveat[_ngcontent-%COMP%]{font-family:Inconsolate,monospace;font-size:30px;font-weight:100}.status-bar[_ngcontent-%COMP%]{width:100%}.stats-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-around;align-items:center;width:30%;height:100%;padding-left:10px}.stats-frame-container[_ngcontent-%COMP%]{width:98%}.weight-container[_ngcontent-%COMP%]{width:44%;display:flex;justify-content:center;align-items:center;height:100%}.list-container[_ngcontent-%COMP%]{padding:0}.center[_ngcontent-%COMP%]{text-align:center}.footer-container[_ngcontent-%COMP%]{justify-content:space-between;align-items:flex-start;padding-left:10px;padding-right:10px}.footer-container[_ngcontent-%COMP%], .stats[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stats[_ngcontent-%COMP%]{justify-content:space-around;align-items:center}.weight-div[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;justify-content:center}.hour[_ngcontent-%COMP%]{padding-right:15px;text-align:end}.footer[_ngcontent-%COMP%]{position:relative}.home[_ngcontent-%COMP%]{position:absolute;bottom:10px;left:50%;background-color:#0000008f;border-radius:50%;padding:11px;z-index:500;box-shadow:0 2px 13px 5px #393a3a}.home-img[_ngcontent-%COMP%]{width:50px}"]}),t})()}];let q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[a.Bz.forChild(v)],a.Bz]}),t})(),U=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[i.ez,o.u5,s.Pc,q,C.hy]]}),t})()}}]);